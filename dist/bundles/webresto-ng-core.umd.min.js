!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/common/http")):"function"==typeof define&&define.amd?define("@webresto/ng-core",["exports","@angular/core","rxjs","rxjs/operators","@angular/common/http"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).webresto=e.webresto||{},e.webresto["ng-core"]={}),e.ng.core,e.rxjs,e.rxjs.operators,e.ng.common.http)}(this,(function(e,t,o,r,n){"use strict";var i=function(e,t,o){this.type=e,this.title=t,this.body=o},u=function(){function e(){this.eventMessage=new t.EventEmitter,this.eventAction=new t.EventEmitter}return e.prototype.emitMessageEvent=function(e){this.eventMessage.emit(e)},e.prototype.emitActionEvent=function(e){this.eventAction.emit(e)},e.prototype.getMessageEmitter=function(){return this.eventMessage},e.prototype.getActionEmitter=function(){return this.eventAction},e}();u.ɵfac=function(e){return new(e||u)},u.ɵprov=t.ɵɵdefineInjectable({token:u,factory:u.ɵfac,providedIn:"root"});var l=function(){this.maintenance$=new o.BehaviorSubject(null)};l.ɵfac=function(e){return new(e||l)},l.ɵprov=t.ɵɵdefineInjectable({token:l,factory:l.ɵfac,providedIn:"root"});var s=function(e){var t=this;this.port=80,this.prefix="api/",this.versionModule="0.5",e.subscribe((function(e){t.url=e}))};s.ɵfac=function(e){return new(e||s)(t.ɵɵinject("ApiDomain"))},s.ɵprov=t.ɵɵdefineInjectable({token:s,factory:s.ɵfac,providedIn:"root"});var c=function(){function e(e,t){this.http=e,this.config=t}return e.prototype.get=function(e,t){return void 0===t&&(t=!0),e=t?this.config.url+this.config.prefix+this.config.versionModule+e:this.config.url+e,this.http.get(e).pipe(r.retry(3))},e.prototype.put=function(e,t,o){return void 0===o&&(o=!0),e=o?this.config.url+this.config.prefix+this.config.versionModule+e:this.config.url+e,this.http.put(e,t)},e.prototype.post=function(e,t,o){return void 0===o&&(o=!0),e=o?this.config.url+this.config.prefix+this.config.versionModule+e:this.config.url+e,this.http.post(e,t)},e}();c.ɵfac=function(e){return new(e||c)(t.ɵɵinject(n.HttpClient),t.ɵɵinject(s))},c.ɵprov=t.ɵɵdefineInjectable({token:c,factory:c.ɵfac,providedIn:"root"});var d=function(){function e(){this.initTypeStorage(),this.event=new o.BehaviorSubject({})}return e.prototype.initTypeStorage=function(){},e.prototype.get=function(e,t){return this[e].get(t)},e.prototype.set=function(e,t,o){return this[e].set(t,o)},e.prototype.sub=function(e,t){var o=this;return this[e].observe().subscribe((function(e){e.key==t&&o.event.next({changeKey:t})})),this.event},e}();d.ɵfac=function(e){return new(e||d)},d.ɵprov=t.ɵɵdefineInjectable({token:d,factory:d.ɵfac,providedIn:"root"});var v=function(){};v.ɵmod=t.ɵɵdefineNgModule({type:v}),v.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||v)},providers:[],imports:[[]]});var a="gf:tkn:v2",f=function(){function e(e,t){this.eventer=e,this.state=t}return e.prototype.intercept=function(e,t){console.info("Interceptor",e);var o=localStorage.getItem(a);return t.handle(o?e.clone({headers:e.headers.set("Authorization","JWT "+o)}):e).pipe(r.tap((function(e){var t,o,r;if(e instanceof n.HttpResponse&&(null===(t=null==e?void 0:e.body)||void 0===t?void 0:t.status)&&(null===(o=null==e?void 0:e.body)||void 0===o?void 0:o.message[0]))throw new Error(null===(r=null==e?void 0:e.body)||void 0===r?void 0:r.message[0])})),r.catchError(this.handleError.bind(this)))},e.prototype.handleError=function(e){var t,r,n,u,l,s,c,d,v,f,p,h,g,m,y,b,w,E;if((null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.enable)&&void 0!==(null===(r=null==e?void 0:e.error)||void 0===r?void 0:r.title)&&void 0!==(null===(n=null==e?void 0:e.error)||void 0===n?void 0:n.description)&&void 0!==(null===(u=null==e?void 0:e.error)||void 0===u?void 0:u.startDate)&&void 0!==(null===(l=null==e?void 0:e.error)||void 0===l?void 0:l.stopDate)){var j=(new Date).getTime(),I=new Date(null===(s=null==e?void 0:e.error)||void 0===s?void 0:s.startDate).getTime(),x=new Date(null===(c=null==e?void 0:e.error)||void 0===c?void 0:c.stopDate).getTime();return j>I&&j<x&&this.state.maintenance$.next({title:e.error.title,description:e.error.description,social:e.error.social}),o.throwError(e.error)}switch(!0){case(null==e?void 0:e.error)instanceof ErrorEvent:return console.error("An error occurred:",null===(d=null==e?void 0:e.error)||void 0===d?void 0:d.message),o.throwError(null==e?void 0:e.error);case e instanceof Error&&"timeout-or-duplicate"==(null==e?void 0:e.message):return console.error("An error occurred:",null==e?void 0:e.message),o.throwError("Ошибка сервера (таймаут). Повторите попытку позже");case e instanceof Error&&"timeout-or-duplicate"!=(null==e?void 0:e.message):return console.error("Backend returned code "+(null==e?void 0:e.status)+", body was: "+(null==e?void 0:e.error)),401==(null==e?void 0:e.status)?(this.eventer.emitMessageEvent(new i("Unauthorized","","")),localStorage.removeItem(a),o.throwError((null===(v=null==e?void 0:e.error)||void 0===v?void 0:v.title)?null===(f=null==e?void 0:e.error)||void 0===f?void 0:f.title:"Необходимо пройти авторизацию")):(404==(null==e?void 0:e.status)&&"User not found"==(null==e?void 0:e.error)?localStorage.removeItem(a):(400==(null==e?void 0:e.status)||500==(null==e?void 0:e.status))&&(null===(h=null===(p=null==e?void 0:e.error)||void 0===p?void 0:p.message)||void 0===h?void 0:h.title)&&(null===(m=null===(g=null==e?void 0:e.error)||void 0===g?void 0:g.message)||void 0===m?void 0:m.body)&&this.eventer.emitMessageEvent(new i("error",null===(b=null===(y=null==e?void 0:e.error)||void 0===y?void 0:y.message)||void 0===b?void 0:b.title,null===(E=null===(w=null==e?void 0:e.error)||void 0===w?void 0:w.message)||void 0===E?void 0:E.body)),o.throwError(null==e?void 0:e.error))}},e}();f.ɵfac=function(e){return new(e||f)(t.ɵɵinject(u),t.ɵɵinject(l))},f.ɵprov=t.ɵɵdefineInjectable({token:f,factory:f.ɵfac}),e.EventMessage=i,e.EventerService=u,e.NetService=c,e.NgCoreModule=v,e.RestoStorageService=d,e.ServerErrorInterceptor=f,e.StateService=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=webresto-ng-core.umd.min.js.map