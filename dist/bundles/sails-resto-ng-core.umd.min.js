!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("@angular/common/http"),require("rxjs/operators"),require("ngx-store")):"function"==typeof define&&define.amd?define("@sails-resto/ng-core",["exports","@angular/core","rxjs","@angular/common/http","rxjs/operators","ngx-store"],t):t((e["sails-resto"]=e["sails-resto"]||{},e["sails-resto"]["ng-core"]={}),e.ng.core,e.rxjs,e.ng.common.http,e.rxjs.operators,null)}(this,function(e,t,o,n,s,r){"use strict";var i=function(e,t,r){this.type=e,this.title=t,this.body=r},a=function(){function e(){this.eventMessage=new t.EventEmitter}return e.prototype.emitMessageEvent=function(e){this.eventMessage.emit(e)},e.prototype.getMessageEmitter=function(){return this.eventMessage},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}(),c=function(){function e(e){var t=this;this.port=80,this.prefix="api/",this.versionModule="0.5",e.subscribe(function(e){t.url=e})}return e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:o.BehaviorSubject,decorators:[{type:t.Inject,args:["ApiDomain"]}]}]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e(t.inject("ApiDomain"))},token:e,providedIn:"root"}),e}(),u=function(){function e(e,t){this.http=e,this.config=t}return e.prototype.get=function(e,t){return void 0===t&&(t=!0),e=t?this.config.url+this.config.prefix+this.config.versionModule+e:this.config.url+e,this.http.get(e).pipe(s.retry(3))},e.prototype.put=function(e,t,r){return void 0===r&&(r=!0),e=r?this.config.url+this.config.prefix+this.config.versionModule+e:this.config.url+e,this.http.put(e,t)},e.prototype.post=function(e,t,r){return void 0===r&&(r=!0),e=r?this.config.url+this.config.prefix+this.config.versionModule+e:this.config.url+e,this.http.post(e,t)},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:n.HttpClient},{type:c}]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e(t.inject(n.HttpClient),t.inject(c))},token:e,providedIn:"root"}),e}(),p=function(){function e(e,t,r){this.cookiesStorageService=e,this.localStorageService=t,this.sharedStorageService=r,this.initTypeStorage(),this.event=new o.BehaviorSubject({})}return e.prototype.initTypeStorage=function(){},e.prototype.get=function(e,t){return this[e].get(t)},e.prototype.set=function(e,t,r){return this[e].set(t,r)},e.prototype.sub=function(e,t){var r=this;return this[e].observe().subscribe(function(e){e.key==t&&r.event.next({changeKey:t})}),this.event},e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:r.CookiesStorageService},{type:r.LocalStorageService},{type:r.SharedStorageService}]},e.ngInjectableDef=t.defineInjectable({factory:function(){return new e(t.inject(r.CookiesStorageService),t.inject(r.LocalStorageService),t.inject(r.SharedStorageService))},token:e,providedIn:"root"}),e}(),f=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[],declarations:[],exports:[]}]}],e}(),g=function(){function e(e){this.eventer=e}return e.prototype.intercept=function(e,t){return t.handle(e).pipe(s.tap(function(e){if(e instanceof n.HttpResponse&&e.body.status&&e.body.message&&e.body.message[0])throw new Error(e.body.message[0])}),s.catchError(this.handleError.bind(this)))},e.prototype.handleError=function(e){if(e.error instanceof ErrorEvent)console.error("An error occurred:",e.error.message);else if(e instanceof Error)switch(console.error("An error occurred:",e.message),e.message){case"timeout-or-duplicate":return o.throwError("Ошибка сервера (таймаут). Повторите попытку позже")}else{if(console.error("Backend returned code "+e.status+", body was: "+e.error),401==e.status)return this.eventer.emitMessageEvent(new i("Unauthorized","","")),o.throwError("Необходимо пройти авторизацию");(400==e.status||500==e.status)&&e.error&&e.error.message&&e.error.message.title&&e.error.message.body&&this.eventer.emitMessageEvent(new i("error",e.error.message.title,e.error.message.body))}return o.throwError(e.error)},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:a}]},e}(),d=function(){function e(e){this.eventer=e}return e.prototype.intercept=function(e,t){var r=this;return t.handle(e).pipe(s.tap(function(e){if(e instanceof n.HttpResponse&&e.body.message&&e.body.message.body&&e.body.message.title&&e.body.message.type)switch(e.body.message.type){case"info":r.eventer.emitMessageEvent(new i("info",e.body.message.title,e.body.message.body));break;case"success":r.eventer.emitMessageEvent(new i("success",e.body.message.title,e.body.message.body));break;case"error":r.eventer.emitMessageEvent(new i("error",e.body.message.title,e.body.message.body));break;case"warning":r.eventer.emitMessageEvent(new i("warning",e.body.message.title,e.body.message.body))}}))},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:a}]},e}(),h=[{provide:n.HTTP_INTERCEPTORS,useClass:g,multi:!0},{provide:n.HTTP_INTERCEPTORS,useClass:d,multi:!0}];e.EventMessage=i,e.EventerService=a,e.NetService=u,e.RestoStorageService=p,e.NgCoreModule=f,e.ngCoreHttpInterceptorProviders=h,e.ServerErrorInterceptor=g,e.ɵb=d,e.ɵa=a,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=sails-resto-ng-core.umd.min.js.map