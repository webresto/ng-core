{"version":3,"sources":["../esm2015/projects/webresto/ng-core/src/lib/services/event-message.ts","../esm2015/projects/webresto/ng-core/src/lib/services/eventer.service.ts","../esm2015/projects/webresto/ng-core/src/lib/services/state.service.ts","../projects/webresto/ng-core/src/lib/config.ts","../esm2015/projects/webresto/ng-core/src/lib/services/net.service.ts","../esm2015/projects/webresto/ng-core/src/lib/services/resto-storage.service.ts","../esm2015/projects/webresto/ng-core/src/lib/http-interceptors/server-error.interceptor.ts","../esm2015/projects/webresto/ng-core/src/lib/http-interceptors/message.interceptor.ts","../projects/webresto/ng-core/src/lib/ng-core.module.ts"],"names":["type","title","body","this","EventerService","eventMessage","EventEmitter","eventAction","prototype","emitMessageEvent","message","emit","emitActionEvent","action","getMessageEmitter","getActionEmitter","Injectable","args","providedIn","maintenance$","BehaviorSubject","endpointUrl","_this","port","prefix","versionModule","subscribe","url","decorators","Inject","NetService","http","config","get","isApi","options","headers","params","pipe","retry","put","data","post","HttpClient","Config","RestoStorageService","initTypeStorage","event","typeStorage","key","set","value","sub","observe","next","changeKey","LS_TOKEN_NAME","ServerErrorInterceptor","eventer","state","intercept","req","authToken","localStorage","getItem","handle","clone","filter","map","console","log","HttpResponse","ok","_a","_c","_b","_d","EventMessage","catchError","err","handleError","error","enable","description","startDate","_e","stopDate","currentTime","Date","getTime","startTime","_f","stopTime","_g","social","throwError","ErrorEvent","_h","_j","_k","status","_l","includes","_m","_o","_q","_p","_s","_r","removeItem","StateService","MessageInterceptor","NgModule","imports","declarations","providers","exports"],"mappings":"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","sourcesContent":["export class EventMessage {\r\n  type:string;\r\n  title:string;\r\n  body:string;\r\n  description?:string;\r\n  data?:any;\r\n\r\n  constructor(type:string, title:string, body:string) {\r\n    this.type = type;\r\n    this.title = title;\r\n    this.body = body;\r\n  }\r\n}\r\n","import { Injectable,EventEmitter } from '@angular/core';\r\nimport { EventMessage } from './event-message';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class EventerService {\r\n  eventMessage: EventEmitter<EventMessage> = new EventEmitter();\r\n  eventAction: EventEmitter<EventMessage> = new EventEmitter();\r\n\r\n  constructor() { }\r\n\r\n  emitMessageEvent(message:EventMessage) {\r\n    this.eventMessage.emit(message);\r\n  }\r\n\r\n  emitActionEvent(action:EventMessage) {\r\n    this.eventAction.emit(action);\r\n  }\r\n\r\n  getMessageEmitter() {\r\n    return this.eventMessage;\r\n  }\r\n  getActionEmitter() {\r\n    return this.eventAction;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class StateService {\r\n  maintenance$: BehaviorSubject<any>;\r\n\r\n  constructor() {\r\n    this.maintenance$ = new BehaviorSubject<any>(null);\r\n  }\r\n}\r\n","import { Inject,Injectable } from '@angular/core';\r\nimport { BehaviorSubject } from 'rxjs';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\n\r\nexport class Config {\r\n  url:any;\r\n  port:number = 80;\r\n  prefix:string = \"api/\";\r\n  versionModule = \"0.5\";\r\n\r\n  constructor(@Inject('ApiDomain') endpointUrl:BehaviorSubject<any>) {\r\n    endpointUrl.subscribe(url=>{\r\n      this.url = url;\r\n    })  \r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Config } from '../config';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { retry } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class NetService {\r\n  constructor(private http: HttpClient, public config: Config) { }\r\n\r\n  public get<T = any>(url: string, isApi: boolean = true, options: {\r\n    headers?: { [header: string]: string },\r\n    params?: { [params: string]: string },\r\n  } = {}): Observable<T> {\r\n    url = isApi\r\n      ? this.config.url + this.config.prefix + this.config.versionModule + url\r\n      : this.config.url + url;\r\n    return this.http.get<T>(url, { headers: options.headers, params: options.params })\r\n      .pipe(\r\n        retry(3) // retry a failed request up to 3 times\r\n      );\r\n  }\r\n\r\n  public put<T = any>(url: string, data: T, isApi: boolean = true): Observable<any> {\r\n\r\n    url = isApi\r\n      ? this.config.url + this.config.prefix + this.config.versionModule + url\r\n      : this.config.url + url;\r\n\r\n    return this.http.put(url, data);\r\n\r\n  }\r\n\r\n  public post<T = any, R = any>(url: string, data: T, isApi: boolean = true, options: {\r\n    headers?: { [header: string]: string },\r\n    params?: { [params: string]: string }\r\n  } = {}): Observable<any> {\r\n\r\n    url = isApi\r\n      ? this.config.url + this.config.prefix + this.config.versionModule + url\r\n      : this.config.url + url;\r\n\r\n    return this.http.post(url, data, { headers: options.headers, params: options.params });\r\n  }\r\n\r\n\r\n\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable, BehaviorSubject } from 'rxjs';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class RestoStorageService {\r\n  event:BehaviorSubject<any>;\r\n  [typeStorage:string]:any;\r\n\r\n  constructor() {\r\n    this.initTypeStorage();\r\n    this.event = new BehaviorSubject({});\r\n  }\r\n\r\n  initTypeStorage() {\r\n    //  this.cookiesStorageService.set('ola', \"work\");\r\n    //  this.localStorageService.set(\"ola\",\"work\");\r\n    //   //  this.sharedStorageService.set(\"ola\",\"work\");\r\n    //   //  console.log(this.cookiesStorageService.get('ola'))\r\n    //   console.log(this.localStorageService.get('olaet'))\r\n    //  console.log(this.sharedStorageService.get('ola'))\r\n\r\n  }\r\n\r\n  get(typeStorage:string, key:string):string {\r\n    return this[typeStorage].get(key);\r\n\r\n  }\r\n\r\n  set(typeStorage:string, key:string, value:string):Observable<any> {\r\n    return this[typeStorage].set(key, value);\r\n  }\r\n\r\n\r\n  sub(typeStorage:string, key:string):Observable<any> {\r\n\r\n    this[typeStorage].observe()\r\n      .subscribe((event:any) => {\r\n        if (event.key == key) {\r\n          this.event.next({\"changeKey\": key})\r\n        }\r\n\r\n      });\r\n    return this.event;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  HttpInterceptor,\r\n  HttpHandler,\r\n  HttpRequest,\r\n  HttpResponse,\r\n  HttpErrorResponse\r\n} from '@angular/common/http';\r\nimport { EventerService } from '../services/eventer.service';\r\nimport { EventMessage } from '../services/event-message';\r\nimport { Observable, throwError } from 'rxjs';\r\nimport { catchError, filter, map } from 'rxjs/operators';\r\nimport { StateService } from \"../services/state.service\";\r\n\r\nconst LS_TOKEN_NAME = 'gf:tkn:v2';\r\n\r\n@Injectable()\r\nexport class ServerErrorInterceptor implements HttpInterceptor {\r\n\r\n  constructor(private eventer: EventerService, private state: StateService) { }\r\n\r\n  intercept(req: HttpRequest<any>, next: HttpHandler) {\r\n    const authToken = localStorage.getItem(LS_TOKEN_NAME);\r\n    return next.handle(!authToken ? req : req.clone({\r\n      headers: req.headers.set('Authorization', `JWT ${authToken}`)\r\n    })).pipe(\r\n      filter(event => !!event.type),\r\n      map(\r\n        event => {\r\n          console.log('event--->>>', event);\r\n          if (event instanceof HttpResponse && event.ok && event?.body?.message && event?.body?.message?.body) {\r\n            const message = event?.body?.message;\r\n            this.eventer.emitMessageEvent(\r\n              new EventMessage(message?.type || '', message?.title || '', message?.body || '')\r\n            );\r\n          };\r\n          return event;\r\n        }\r\n      ),\r\n      catchError(err => this.handleError(err))\r\n    );\r\n  }\r\n\r\n  handleError(error: HttpErrorResponse):Observable<never> {\r\n    if (error?.error?.enable && error?.error?.title && error?.error?.description && error?.error?.startDate && error?.error?.stopDate) {\r\n      const currentTime = new Date().getTime(),\r\n        startTime = new Date(error?.error?.startDate).getTime(),\r\n        stopTime = new Date(error?.error?.stopDate).getTime();\r\n      if (currentTime > startTime && currentTime < stopTime) {\r\n        this.state.maintenance$.next({\r\n          title: error.error.title,\r\n          description: error.error.description,\r\n          social: error.error.social\r\n        });\r\n      };\r\n      return throwError(error.error);\r\n    } else {\r\n      switch (true) {\r\n        case error?.error instanceof ErrorEvent:\r\n        console.error('An error occurred:', error?.error?.message);\r\n        return throwError(error?.error);;\r\n\r\n        case (error.error?.message == 'timeout-or-duplicate'):\r\n          console.error('An error occurred:', error?.message);\r\n          return throwError('Ошибка сервера (таймаут). Повторите попытку позже');\r\n\r\n        case (error.error?.message != 'timeout-or-duplicate'):\r\n          console.error(`Backend returned code ${error?.status}, ` + `body was: `, error?.error);\r\n          if (!(error.status == 404 && (error?.url?.includes('images') && (error?.url?.includes('.jpg') || error?.url?.includes('png'))))) {\r\n            this.eventer.emitMessageEvent(\r\n              new EventMessage('error', error?.error?.message?.title || '', error?.error?.message?.body || '')\r\n            );\r\n          };\r\n          if (error?.status == 401 || (error?.status == 404 && error?.error == \"User not found\")) {\r\n            console.log('очистка Storage');\r\n            localStorage.removeItem(LS_TOKEN_NAME);\r\n          };\r\n          return throwError(error?.error);\r\n        default: return throwError(error?.error);\r\n      };\r\n    };\r\n    // return an observable with a user-facing error message\r\n  };\r\n\r\n}","import { Injectable } from '@angular/core';\r\nimport {\r\n  HttpInterceptor,\r\n  HttpHandler,\r\n  HttpRequest,\r\n  HttpResponse,\r\n} from '@angular/common/http';\r\nimport { EventerService } from '../services/eventer.service';\r\nimport { EventMessage } from '../services/event-message';\r\nimport { map } from 'rxjs/operators';\r\nimport { StateService } from \"../services/state.service\";\r\n\r\n@Injectable()\r\nexport class MessageInterceptor implements HttpInterceptor {\r\n\r\n  constructor(\r\n    private eventer: EventerService,\r\n    private state: StateService\r\n  ) { }\r\n\r\n  intercept(req: HttpRequest<any>, next: HttpHandler) {\r\n\r\n    return next.handle(req)\r\n      .pipe(\r\n        map(\r\n          event => {\r\n            if (event instanceof HttpResponse && event.body?.enable\r\n              && typeof event.body.title !== 'undefined'\r\n              && typeof event.body.description !== 'undefined'\r\n              && typeof event.body.startDate !== 'undefined'\r\n              && typeof event.body.stopDate !== 'undefined') {\r\n              const currentTime = new Date().getTime(),\r\n                startTime = new Date(event.body.startDate).getTime(),\r\n                stopTime = new Date(event.body.stopDate).getTime();\r\n\r\n              if (currentTime > startTime && currentTime < stopTime) {\r\n                this.state.maintenance$.next({\r\n                  title: event.body.title,\r\n                  description: event.body.description\r\n                });\r\n              }\r\n            } else if (event instanceof HttpResponse && event?.body?.message?.body && event?.body?.message?.title && event?.body?.message?.type) {\r\n              this.eventer.emitMessageEvent(\r\n                new EventMessage(event.body.message.type, event.body.message.title, event.body.message.body)\r\n              );\r\n            };\r\n            return event;\r\n          })\r\n      );\r\n  }\r\n}","import { NgModule } from '@angular/core';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [],\r\n  providers:[],\r\n  exports: []\r\n})\r\nexport class NgCoreModule { }\r\n"]}